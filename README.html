<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link type="text/css" rel="stylesheet" href="css/import.css"/>
    <title>GroovyServ @ GitHub</title>
  </head>
  <body>
    <div id="container">
      <div id="header">
        <img id="logo" src="images/logo.png" alt="GroovyServ" />
        <div id="project">
          by <a href="http://github.com/kobo">kobo</a> project
        </div>
      </div>

      <div id="nav">
        <ul>
          <li><a class="home" href="index.html">Home</a></li>
          <li><a class="document" href="document.html">Documentation</a></li>
          <li><a class="download" href="download.html">Download</a></li>
          <li><a class="source" href="http://github.com/kobo/groovyserv">Source</a></li>
        </ul>
      </div>

      <div id="content">
        <div class="section">
          <h2>README</h2>
          <pre>
==============
Introduction
==============

GroovyServ makes startup time quicker, by pre-invoking groovy as a TCP/IP
server. (If you know gnuserv/gnuclient, this is like that.)

In the case of scripting in dynamic-type languages, quick response about
invocation is very important. Try-and-run cycles is repeated frequently
than static-type languages, so sometimes 2 seconds or even a second might
be intolerable.

GroovyServ reduces the startup time of JVM and Groovy runtime
significantly. In most situations it is 10 to 20 times faster than
regular Groovy. The following times are averages of 3 times which
measured invocation in Groovy 1.7 on Windows XP (Core(TM) 2 Duo 2GHz).

  Groovy(non native)  2.32 (sec)
  Groovy(native exe)  0.90 (sec)
  GroovyServ          0.10 (sec)

==============
Requirements
==============

GroovyServ is developed for following environment/OS. Please report if it
runs on the others.

  - Windows XP + cygwin
  - Windows XP without cygwin
  - Mac OS X 10.5/6 (Intel Mac)
  - Ubuntu Linux 9.10

Version of Groovy is following:

  - Groovy 1.7 or later

==========
Language
==========

The Server is written in Java with JNA(Java Native Access).  There are
two types of clients, one is written in C and another is written in Ruby.

==========
Security
==========

GroovyServ has a possibility to run any groovy script from client.
So server-client connection is limited to the connection from the same
machine (localhost). And the connection is authenticated by simple
cookie mechanism. The cookie file is stored at ~/.groovy/groovyserv/cookie
and the file mode set to 0400. But in Windows environment, it is not
effective. So appropriately protect access to the file in Windows if
needed.

=============================
Install from binary package
=============================

Download and expand GroovyServ distribution package

  groovyserv-0.3-win32-bin.zip

or

  groovyserv-0.3-MacOSX-x86_64-bin.zip

to any directory. For example:

  &gt; mkdir ~/opt
  &gt; cd ~/opt
  &gt; unzip groovyserv-0.3-win32-bin.zip

and add bin directory to PATH environment variable.
For example in bash/bourne shell:

  export PATH=~/opt/groovyserv-0.3/bin:$PATH

That's all for preparing. When you invoke groovyclient, groovyserver
automatically starts in background. At first, you might have to wait
for a few seconds to startup.

  &gt; groovyclient -v
  starting server..
  Groovy Version: 1.7.3 JVM: 1.6.0_20

========================
Build from source code
========================

Download and expand GroovyServ source package groovyserv-0.3-src.zip
to any directory. For example:

  &gt; mkdir -p ~/opt/src
  &gt; cd ~/opt/src
  &gt; unzip groovyserv-0.3-src.zip

Build with Maven2 as follows:

  &gt; cd ~/opt/src/groovyserv-0.3/
  &gt; mvn clean verify

Then some zip files will be generated. According to "Install from
binary package", install the bin package.

  ~/opt/src/groovyserv-0.3/target/groovyserv-0.3-&lt;OS&gt;-&lt;arch&gt;-bin.zip

If some tests fail, you can try as follows:

  with UTF-8 encoding:

    &gt; export _JAVA_OPTIONS=-Dfile.encoding=UTF-8
    &gt; mvn clean verify

  skip integration tests:

    &gt; mvn clean package

  skip all tests:

    &gt; mvn -Dmaven.test.skip=true clean package

=======================
Environment variables
=======================

GroovyServ uses all three following environment variables in runtime.

  HOME

    It's used to decide ~/.groovy/groovyserv directory path.
    It's set by default if in unix-like OS, but in Windows you must set by yourself.
    Add HOME as user variables in [System Properties&gt;Advanced&gt;Environment Variables].
    It may need to restart Windows.

  JAVA_HOME

    It's used by Groovy.
    Generally, it has been already set through installing Groovy.

  GROOVY_HOME

    It's used to specify groovy command path.
    Generally, it has been already set through installing Groovy.

============
How to use
============

You can use 'groovyclient' command as a replacement of 'groovy'
command.  If the server is not running, it starts automatically. You
can also invoke the serverexplicitly.

  &gt; groovyserver

About groovyserver command options refer to "groovyserver options"
section.

=========================
Restriction/Differences
=========================

* You can't concurrently use different current directory on a server.
  If you execute the following,

  &gt; groovyclient ... | (cd /tmp; groovyclient ... )

  the following exception will be occurred:

    org.jggug.kobo.groovyserv.GroovyServException: Can't change current
    directory because of another session running on different dir: ...

  It also meets conditions if you invoke groovyclient simultaneously
  from two or more consoles. But if the running periods of each
  groovyclient are not overlapping, it can run without exception.

  If needed, you can run multiple groovy servers for separated ports.

* A static variable is shared among groovy program executions.
  For instance, the system properties are shared.

 &gt; groovy -e "System.setProperty('a','abc')"
 &gt; groovy -e "println System.getProperty('a')"
 abc

* Environment variables at which the groovyclient started is not used
  and those of groovyserver is invoked are used. If you want to apply
  new environment variables to running groovyserver process, you must
  restart the server.

  &gt; groovyserver -r

  But as an exception, the value of CLASSPATH variable of which the
  groovyclient started is effective.

* Values of Groovy's -cp option and CLASSPATH variable are passed to the
  server and added/overwrote to environment variables of the server
  process. But it is only to add, never to remove.

======================
groovyserver options
======================

Options are as follows:

  -q        quiet (default)
  -v        verbose output. print debugging information etc.
  -k        kill the running groovyserver (groovyserver.bat cannot use this)
  -r        restart groovyserver (groovyserver.bat cannot use this)
  -p &lt;port&gt; specify the port that connected from groovyclient

=============
Port number
=============

To change the port number which groovyserver uses, you can use
GROOVYSERVER_PORT environment variable instead of -p option.

  &gt; export GROOVYSERVER_PORT=1963

groovyclient uses GROOVYSERVER_PORT variable in default. But you can
specify port number by -p option of groovyclient. In groovyclient, -p
option is treated more prior than GROOVYSERVER_PORT environment variable.

==========
Log file
==========

The output from groovyserver are logged to:

  ~/.groovy/groovyserv/groovyserver.log

======
Tips
======

Following aliases might be useful.

  alias groovy=groovyclient

For Windows environment:

  doskey groovy=groovyclient $*
          </pre>
        </div>
      </div>

      <div id="footer">
        Get the source code on GitHub : <a href="http://github.com/kobo/groovyserv">kobo/groovyserv</a>
      </div>
    </div>

    <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
      try {
        var pageTracker = _gat._getTracker("UA-3438563-4");
        pageTracker._trackPageview();
      } catch(err) {}
    </script>
  </body>
</html>
